<div class="container mt-3">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Metrics</h1>
    <% if @most_recent_metric&.created_at&.to_date != Date.today %>
      <%= link_to "Daily Check In", new_metric_path, class: "btn btn-primary", "data-bs-toggle": "modal", "data-bs-target": "#newMetricModal", "data-url": new_metric_path %>
    <% end %>
  </div>
  <%= @bmi&.round(2) %>

  <div class="scrollable-chart">
    <%= line_chart [
        {name: "Total Weight", data: @weight_by_day},
        {name: "Fat Mass", data: @fat_mass_by_day},
        {name: "Muscle Mass", data: @muscle_mass_by_day}
      ], 
      id: "mass-chart", 
      xtitle: "Date", 
      ytitle: "Pounds",
      library: {title: "Mass Chart"} 
    %>
  </div>
  <div class="scrollable-chart">
    <%= line_chart [
        {name: "Fat Percentage", data: @fat_percentage_by_day},
        {name: "Muscle Percentage", data: @muscle_percentage_by_day}
      ], 
      id: "percentage-chart", 
      xtitle: "Date", 
      ytitle: "Percent", 
      library: {title: "Percentage Chart"} 
    %>

  </div>
</div>

<div class="modal fade" id="newMetricModal" tabindex="-1" aria-labelledby="newMetricModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="newMetricModalLabel">New Metric</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <%= render 'form', metric: Metric.new %>
      </div>
    </div>
  </div>
</div>

<style>

.scrollable-chart {
  overflow-x: auto;
  white-space: nowrap;
}
#combined-chart {
  display: inline-block;
  width: auto; /* Adjust this based on your needs */
  min-width: 1000px; /* This should be large enough to accommodate all points */
}
</style>